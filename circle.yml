machine:
  php:
    version: 5.4.5
dependencies:
  pre:
    - pecl install gearman

checkout:
  post:
    - cp ./config/local.php_sample ./config/local.php
    - sed -i s@\<mopidy_host\>@${MOPIDY_HOST}@g ./config/local.php
    - sed -i s@\<slack_url\>@${SLACK_URL}@g ./config/local.php

deployment:
  production:
    branch: master
    commands:
      - ssh root@${DEPLOY_HOST} -p 6682 'cd /pidata/www/slackpi && git pull && supervisorctl restart pimusic_getter:*'

notify:
  webhooks:
    # A list of hook hashes, containing the URL field
    - url: https://hooks.slack.com/services/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